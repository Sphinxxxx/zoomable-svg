/*!
    zoomable-svg  v0.2.0 (2018-04-06)

    Zoom in on any SVG
    https://github.com/Sphinxxxx/zoomable-svg

    Copyright (c) 2018 Andreas Borgen (https://github.com/Sphinxxxx)
    Licensed under the MIT license.
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.zoomableSvg=e()}(this,function(){"use strict";const t=window;return function(e,n){function o(t,e,n){function o(t,e,n){return Math.max(e,Math.min(t,n))}var i=e.getBoundingClientRect(),c=t.clientX-i.left,r=t.clientY-i.top;return n&&(c=o(c,0,i.width),r=o(r,0,i.height)),{x:c,y:r}}function i(t,e){this.x=t,this.y=e}i.prototype.negate=function(){return new i(-this.x,-this.y)},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y)},"string"==typeof e&&(e=document.querySelector(e));var c=(n=n||{}).container||e,r=void 0,a=void 0,u=void 0,l=void 0,h=void 0;function s(t,e){f(u*=1+t,e)}function f(t,e){var n,o=l.width/t,c=l.height/t,r=o/h.width,a={w:l.width*r,h:l.height*r,t:e.y-e.y*r,l:e.x-e.x*r};n=g(new i(a.l,a.t)),h.top=n.y,h.left=n.x,h.width=o,h.height=c,p()}function d(t){var e=g(t.negate());h.top=e.y,h.left=e.x,p()}function g(t){var e=t.x/l.width,n=t.y/l.height;return new i(h.width*e+h.left,h.height*n+h.top)}function p(){var t=w();e.setAttribute("viewBox",t),n.onChanged&&n.onChanged.call(v)}function w(){return[h.left,h.top,h.width,h.height]}var v={Coord:i,vp2vb:g,getZoom:function(){return u},setZoom:f,moveViewport:d,getViewBox:w};return function(){function n(){u=l.width/h.width,s(0,new i(0,0))}l={width:c.clientWidth,height:c.clientHeight},(h=function(t){var e=t&&t.split(/[ ,]/).filter(function(t){return t.length}).map(function(t){return Number(t)});if(e&&4===e.length)return{left:e[0],top:e[1],width:e[2],height:e[3]}}(e.getAttribute("viewBox")))?n():(u=1,h={left:0,top:0,width:l.width,height:l.height},p()),window.addEventListener("resize",function(t){l={width:c.clientWidth,height:c.clientHeight},n()}),c.addEventListener("wheel",function(t){t.preventDefault(),s(t.deltaY>0?-.1:.1,o(t,c))}),c.addEventListener("touchmove",function(t){var e=t.touches;if(2===e.length){t.preventDefault();var n=o(e[0],c),r=o(e[1],c),u=n.x-r.x,l=n.y-r.y,h={center:new i((n.x+r.x)/2,(n.y+r.y)/2),dist:Math.sqrt(u*u+l*l)};a&&(d(h.center.subtract(a.center)),s(h.dist/a.dist-1,h.center)),a=h}else a=null}),c.addEventListener("touchend",function(t){a=null}),function(e){const n=Element.prototype;n.matches||(n.matches=n.msMatchesSelector||n.webkitMatchesSelector),n.closest||(n.closest=function(t){var e=this;do{if(e.matches(t))return e;e="svg"===e.tagName?e.parentNode:e.parentElement}while(e);return null});const o=(e=e||{}).container||document.documentElement,i=e.selector,c=e.callback||console.log,r=e.callbackDragStart,a=e.callbackDragEnd,u=e.callbackClick,l=e.propagateEvents,h=!1!==e.roundCoords,s=!1!==e.dragOutside,f=e.handleOffset||!1!==e.handleOffset;let d,g=null;switch(f){case"center":g=!0;break;case"topleft":case"top-left":g=!1}function p(t,e,n,i){let c=t.clientX,r=t.clientY;function a(t,e,n){return Math.max(e,Math.min(t,n))}if(e){const t=e.getBoundingClientRect();c-=t.left,r-=t.top,n&&(c-=n[0],r-=n[1]),i&&(c=a(c,0,t.width),r=a(r,0,t.height)),e!==o&&(null!==g?g:"circle"===e.nodeName||"ellipse"===e.nodeName)&&(c-=t.width/2,r-=t.height/2)}return h?[Math.round(c),Math.round(r)]:[c,r]}function w(t){t.preventDefault(),l||t.stopPropagation()}function v(t){let e;if(e=i?i instanceof Element?i.contains(t.target)?i:null:t.target.closest(i):{}){w(t);const n=i&&f?p(t,e):[0,0],c=p(t,o,n);d={target:e,mouseOffset:n,startPos:c,actuallyDragged:!1},r&&r(e,c)}}function m(t){if(!d)return;w(t);const e=d.startPos,n=p(t,o,d.mouseOffset,!s);d.actuallyDragged=d.actuallyDragged||e[0]!==n[0]||e[1]!==n[1],c(d.target,n,e)}function y(t,e){if(d){if(a||u){const n=!d.actuallyDragged,i=n?d.startPos:p(t,o,d.mouseOffset,!s);u&&n&&!e&&u(d.target,i),a&&a(d.target,i,d.startPos,e||n&&u)}d=null}}function b(t,e){y(k(t),e)}function x(t,e,n){t.addEventListener(e,n)}function D(t){return void 0!==t.buttons?1===t.buttons:1===t.which}function E(t,e){1===t.touches.length?e(k(t)):y(t,!0)}function k(t){let e=t.targetTouches[0];return e||(e=t.changedTouches[0]),e.preventDefault=t.preventDefault.bind(t),e.stopPropagation=t.stopPropagation.bind(t),e}x(o,"mousedown",function(t){D(t)?v(t):y(t,!0)}),x(o,"touchstart",t=>E(t,v)),x(t,"mousemove",function(t){d&&(D(t)?m(t):y(t))}),x(t,"touchmove",t=>E(t,m)),x(o,"mouseup",function(t){d&&!D(t)&&y(t)}),x(o,"touchend",t=>b(t)),x(o,"touchcancel",t=>b(t,!0))}({container:c,callbackDragStart:function(t,e){r=e},callback:function(t,e,n){d(new i(e[0]-r[0],e[1]-r[1])),r=e},callbackDragEnd:function(){r=null}})}(),v}});
