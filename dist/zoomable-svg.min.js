!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.zoomableSvg=e()}(this,function(){"use strict";return function(t,e){function n(t,e,n){function i(t,e,n){return Math.max(e,Math.min(t,n))}var o=e.getBoundingClientRect(),r=t.clientX-o.left,c=t.clientY-o.top;return n&&(r=i(r,0,o.width),c=i(c,0,o.height)),{x:r,y:c}}function i(t,e){this.x=t,this.y=e}i.prototype.negate=function(){return new i(-this.x,-this.y)},i.prototype.subtract=function(t){return new i(this.x-t.x,this.y-t.y)},"string"==typeof t&&(t=document.querySelector(t));var o=(e=e||{}).container||t,r=void 0,c=void 0,a=void 0,u={width:o.clientWidth,height:o.clientHeight},h=function(t){var e=t&&t.split(/[ ,]/).filter(function(t){return t.length}).map(function(t){return Number(t)});if(e&&4===e.length)return{left:e[0],top:e[1],width:e[2],height:e[3]}}(t.getAttribute("viewBox")),l={getViewBox:v,getZoom:function(){return a},vp2vb:s};function d(t,e){!function(t,e){var n,o=u.width/t,r=u.height/t,c=o/h.width,a={w:u.width*c,h:u.height*c,t:e.y-e.y*c,l:e.x-e.x*c};n=s(new i(a.l,a.t)),h.top=n.y,h.left=n.x,h.width=o,h.height=r,g()}(a*=1+t,e)}function f(t){var e=s(t.negate());h.top=e.y,h.left=e.x,g()}function s(t){var e=t.x/u.width,n=t.y/u.height;return new i(h.width*e+h.left,h.height*n+h.top)}function v(){return[h.left,h.top,h.width,h.height]}function g(){var n=v();t.setAttribute("viewBox",n),e.onChanged&&e.onChanged.call(l)}return h?(a=u.width/h.width,e.container&&d(0,new i(0,0))):(a=1,h={left:0,top:0,width:u.width,height:u.height},g()),o.addEventListener("wheel",function(t){t.preventDefault(),d(t.deltaY>0?-.1:.1,n(t,o))}),o.addEventListener("touchmove",function(t){var e=t.touches;if(2===e.length){t.preventDefault();var r=n(e[0],o),a=n(e[1],o),u=r.x-a.x,h=r.y-a.y,l={center:new i((r.x+a.x)/2,(r.y+a.y)/2),dist:Math.sqrt(u*u+h*h)};c&&(f(l.center.subtract(c.center)),d(l.dist/c.dist-1,l.center)),c=l}else c=null}),o.addEventListener("touchend",function(t){c=null}),function(t){var e=Element.prototype;e.matches||(e.matches=e.msMatchesSelector||e.webkitMatchesSelector),e.closest||(e.closest=function(t){var e=this;do{if(e.matches(t))return e;e="svg"===e.tagName?e.parentNode:e.parentElement}while(e);return null});var n=(t=t||{}).container||document.documentElement,i=t.selector,o=t.callback||console.log,r=t.callbackDragStart,c=t.callbackDragEnd,a=t.callbackClick,u=!1!==t.roundCoords,h=!1!==t.dragOutside,l=t.handleOffset||!1!==t.handleOffset,d=null;switch(l){case"center":d=!0;break;case"topleft":case"top-left":d=!1}var f=void 0,s=void 0,v=void 0;function g(t,e,i,o){var r=t.clientX,c=t.clientY;function a(t,e,n){return Math.max(e,Math.min(t,n))}if(e){var h=e.getBoundingClientRect();r-=h.left,c-=h.top,i&&(r-=i[0],c-=i[1]),o&&(r=a(r,0,h.width),c=a(c,0,h.height)),e!==n&&(null!==d?d:"circle"===e.nodeName||"ellipse"===e.nodeName)&&(r-=h.width/2,c-=h.height/2)}return u?[Math.round(r),Math.round(c)]:[r,c]}function p(t){(f=i?t.target.closest(i):{})&&(t.preventDefault(),t.stopPropagation(),s=i&&l?g(t,f):[0,0],v=g(t,n,s),u&&(v=v.map(Math.round)),r&&r(f,v))}function w(t){if(f){t.preventDefault(),t.stopPropagation();var e=g(t,n,s,!h);o(f,e,v)}}function m(t){if(f){if(c||a){var e=g(t,n,s,!h);a&&v[0]===e[0]&&v[1]===e[1]&&a(f,v),c&&c(f,e,v)}f=null}}function y(t){m(E(t))}function b(t){return void 0!==t.buttons?1===t.buttons:1===t.which}function x(t,e){1===t.touches.length?e(E(t)):m(t)}function E(t){var e=t.targetTouches[0];return e||(e=t.changedTouches[0]),e.preventDefault=t.preventDefault.bind(t),e.stopPropagation=t.stopPropagation.bind(t),e}n.addEventListener("mousedown",function(t){b(t)&&p(t)}),n.addEventListener("touchstart",function(t){x(t,p)}),window.addEventListener("mousemove",function(t){f&&(b(t)?w(t):m(t))}),window.addEventListener("touchmove",function(t){x(t,w)}),window.addEventListener("mouseup",function(t){f&&!b(t)&&m(t)}),n.addEventListener("touchend",y),n.addEventListener("touchcancel",y)}({container:o,callbackDragStart:function(t,e){r=e},callback:function(t,e,n){f(new i(e[0]-r[0],e[1]-r[1])),r=e},callbackDragEnd:function(){r=null}}),l}});
